<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><title>非公式 - Visual Studio Code Docs</title><meta name="description" content="Visual Studio Code (VS Code) Docs の日本語訳"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://vscode-doc-jp.github.io/docs/extensionapi/vscode-api-commands.html"><link rel="stylesheet" href="/css/navy.css"><link rel="stylesheet" href="/css/accordion.css"><link rel="alternate" href="/atom.xml" title="非公式 - Visual Studio Code Docs"><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-92801937-1","auto"),ga("send","pageview")</script></head><body><div id="container"><header id="header" class="wrapper"><div id="header-inner" class="inner"><h1 id="logo-wrap"><a href="/" id="logo">Visual Studio Code</a></h1><nav id="main-nav"><a href="/docs/" class="main-nav-link">Docs</a><a href="/updates/" class="main-nav-link">Updates</a><div id="search-input-wrap"><div id="search-input-icon"><i class="fa fa-search"></i></div><input type="search" id="search-input" placeholder="Search..."></div></nav><a id="mobile-nav-toggle"><span class="mobile-nav-toggle-bar"></span> <span class="mobile-nav-toggle-bar"></span> <span class="mobile-nav-toggle-bar"></span></a></div></header><div id="content-wrap"><div id="content" class="wrapper"><div id="content-inner"><header role="navigation"><div class="inner"><nav class="small_nav"><h4>Topics</h4><form name="SmallNav"><select class="small_nav_dropdown" name="doropdown" onchange="location.href=document.SmallNav.doropdown.options[document.SmallNav.doropdown.selectedIndex].value"><optgroup class="small-nav-title" label="Setup"><option value="/docs/setup/setup-overview.html" class="small-nav-link" undefined>Overview</option><option value="/docs/setup/linux.html" class="small-nav-link" undefined>Linux</option><option value="/docs/setup/windows.html" class="small-nav-link" undefined>Windows</option><option value="/docs/setup/network.html" class="small-nav-link" undefined>Network</option><option value="/docs/setup/additional-components.html" class="small-nav-link" undefined>Additional Compnents</option></optgroup><optgroup class="small-nav-title" label="GetStarted"><option value="/docs/getstarted/introvideos.html" class="small-nav-link" undefined>Intro Videos</option><option value="/docs/getstarted/userinterface.html" class="small-nav-link" undefined>User Interface</option><option value="/docs/getstarted/themes.html" class="small-nav-link" undefined>Themes</option><option value="/docs/getstarted/settings.html" class="small-nav-link" undefined>Settings</option><option value="/docs/getstarted/keybindings.html" class="small-nav-link" undefined>Key Bindings</option><option value="/docs/getstarted/locales.html" class="small-nav-link" undefined>Display Language</option></optgroup><optgroup class="small-nav-title" label="UserGuide"><option value="/docs/userguide/codebasics.html" class="small-nav-link" undefined>Basic Editing</option><option value="/docs/userguide/intellisense.html" class="small-nav-link" undefined>IntelliSense</option><option value="/docs/userguide/editingevolved.html" class="small-nav-link" undefined>Code Navigation</option><option value="/docs/userguide/debugging.html" class="small-nav-link" undefined>Debugging</option><option value="/docs/userguide/versioncontrol.html" class="small-nav-link" undefined>Version Control</option><option value="/docs/userguide/integrated-terminal.html" class="small-nav-link" undefined>Integrated Terminal</option><option value="/docs/userguide/tasks.html" class="small-nav-link" undefined>Tasks</option><option value="/docs/userguide/userdefinedsnippets.html" class="small-nav-link" undefined>Creating your own Snippets</option><option value="/docs/userguide/emmet.html" class="small-nav-link" undefined>Emmet</option><option value="/docs/userguide/command-line.html" class="small-nav-link" undefined>Command Line</option><option value="/docs/userguide/accessibility.html" class="small-nav-link" undefined>Accessibility</option></optgroup><optgroup class="small-nav-title" label="Languages"><option value="/docs/languages/overview.html" class="small-nav-link" undefined>Overview</option><option value="/docs/languages/html.html" class="small-nav-link" undefined>HTML</option><option value="/docs/languages/css.html" class="small-nav-link" undefined>CSS, Sass and Less</option><option value="/docs/languages/cpp.html" class="small-nav-link" undefined>C++</option></optgroup><optgroup class="small-nav-title" label="Extensions"><option value="/docs/extensions/overview.html" class="small-nav-link" undefined>Overview</option><option value="/docs/extensions/yocode.html" class="small-nav-link" undefined>Extension Generator</option><option value="/docs/extensions/samples.html" class="small-nav-link" undefined>Additional Examples</option><option value="/docs/extensions/publish-extension.html" class="small-nav-link" undefined>Publishing Extensions</option></optgroup><optgroup class="small-nav-title" label="ExtensionAPI"><option value="/docs/extensionapi/overview.html" class="small-nav-link" undefined>Overview</option><option value="/docs/extensionapi/extension-manifest.html" class="small-nav-link" undefined>Extension Manifest</option><option value="/docs/extensionapi/extension-points.html" class="small-nav-link" undefined>Extension Points</option><option value="/docs/extensionapi/activation-events.html" class="small-nav-link" undefined>Activation Events</option><option value="/docs/extensionapi/vscode-api.html" class="small-nav-link" undefined>vscode namespace API</option><option value="/docs/extensionapi/vscode-api-commands.html" class="small-nav-link selected" undefined selected>Complex Commands</option><option value="/docs/extensionapi/api-scm.html" class="small-nav-link" undefined>Source Control API</option></optgroup><optgroup class="small-nav-title" label="Supporting"><option value="/docs/supporting/faq.html" class="small-nav-link" undefined>FAQ</option><option value="/docs/supporting/requirements.html" class="small-nav-link" undefined>Requirements</option><option value="/docs/supporting/errors.html" class="small-nav-link" undefined>Errors</option></optgroup><optgroup class="small-nav-title" label="Other"><option value="/docs/other/dotnet.html" class="small-nav-link" undefined>.NET Core</option></optgroup></select></form></nav></div></header><article class="article-container" itemscope itemtype="http://schema.org/Article"><div class="article-inner"><div class="article"><div class="inner"><header class="article-header"><h1 class="article-title" itemprop="name"></h1><a href="https://github.com/vscode-doc-jp/Docs/edit/master/extensionapi/vscode-api-commands.md" class="article-edit-link" title="Improve this doc"><div class="fa"></div></a><h2><time class="article-updated" data-position="header" datetime="2017-06-09T10:29:06.984Z" itemprop="dateModified">Last updated: 2017-06-09</time></h2></header><div class="article-content" itemprop="articleBody"><h1 id="Complex-Commands" class="article-heading"><a href="#Complex-Commands" class="headerlink" title="Complex Commands"></a>Complex Commands<a class="article-anchor" href="#Complex-Commands" aria-hidden="true"></a></h1><p>This document lists the set of Visual Studio Code complex commands. They are called complex commands because they require parameters and often return a value. You can use the commands in conjunction with the <code>executeCommand</code> API.</p><p>The following is a sample of how to preview a HTML document:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> uri = Uri.parse(<span class="string">'file:///some/path/to/file.html'</span>);</div><div class="line"><span class="keyword">let</span> success = <span class="keyword">await</span> commands.executeCommand(<span class="string">'vscode.previewHtml'</span>, uri);</div></pre></td></tr></table></figure><h2 id="Commands" class="article-heading"><a href="#Commands" class="headerlink" title="Commands"></a>Commands<a class="article-anchor" href="#Commands" aria-hidden="true"></a></h2><p><code>vscode.executeWorkspaceSymbolProvider</code> - Execute all workspace symbol provider.</p><ul><li><em>query</em> Search string</li><li><em>(returns)</em> A promise that resolves to an array of SymbolInformation-instances.</li></ul><p><code>vscode.executeDefinitionProvider</code> - Execute all definition provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>position</em> Position of a symbol</li><li><em>(returns)</em> A promise that resolves to an array of Location-instances.</li></ul><p><code>vscode.executeImplementationProvider</code> - Execute all implementation providers.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>position</em> Position of a symbol</li><li><em>(returns)</em> A promise that resolves to an array of Location-instance.</li></ul><p><code>vscode.executeHoverProvider</code> - Execute all hover provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>position</em> Position of a symbol</li><li><em>(returns)</em> A promise that resolves to an array of Hover-instances.</li></ul><p><code>vscode.executeDocumentHighlights</code> - Execute document highlight provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>position</em> Position in a text document</li><li><em>(returns)</em> A promise that resolves to an array of DocumentHighlight-instances.</li></ul><p><code>vscode.executeReferenceProvider</code> - Execute reference provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>position</em> Position in a text document</li><li><em>(returns)</em> A promise that resolves to an array of Location-instances.</li></ul><p><code>vscode.executeDocumentRenameProvider</code> - Execute rename provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>position</em> Position in a text document</li><li><em>newName</em> The new symbol name</li><li><em>(returns)</em> A promise that resolves to a WorkspaceEdit.</li></ul><p><code>vscode.executeSignatureHelpProvider</code> - Execute signature help provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>position</em> Position in a text document</li><li><em>triggerCharacter</em> (optional) Trigger signature help when the user types the character, like <code>,</code> or <code>(</code></li><li><em>(returns)</em> A promise that resolves to SignatureHelp.</li></ul><p><code>vscode.executeDocumentSymbolProvider</code> - Execute document symbol provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>(returns)</em> A promise that resolves to an array of SymbolInformation-instances.</li></ul><p><code>vscode.executeCompletionItemProvider</code> - Execute completion item provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>position</em> Position in a text document</li><li><em>triggerCharacter</em> (optional) Trigger completion when the user types the character, like <code>,</code> or <code>(</code></li><li><em>(returns)</em> A promise that resolves to a CompletionList-instance.</li></ul><p><code>vscode.executeCodeActionProvider</code> - Execute code action provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>range</em> Range in a text document</li><li><em>(returns)</em> A promise that resolves to an array of Command-instances.</li></ul><p><code>vscode.executeCodeLensProvider</code> - Execute CodeLens provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>(returns)</em> A promise that resolves to an array of CodeLens-instances.</li></ul><p><code>vscode.executeFormatDocumentProvider</code> - Execute document format provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>options</em> Formatting options</li><li><em>(returns)</em> A promise that resolves to an array of TextEdits.</li></ul><p><code>vscode.executeFormatRangeProvider</code> - Execute range format provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>range</em> Range in a text document</li><li><em>options</em> Formatting options</li><li><em>(returns)</em> A promise that resolves to an array of TextEdits.</li></ul><p><code>vscode.executeFormatOnTypeProvider</code> - Execute document format provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>position</em> Position in a text document</li><li><em>ch</em> Character that got typed</li><li><em>options</em> Formatting options</li><li><em>(returns)</em> A promise that resolves to an array of TextEdits.</li></ul><p><code>vscode.executeLinkProvider</code> - Execute document link provider.</p><ul><li><em>uri</em> Uri of a text document</li><li><em>(returns)</em> A promise that resolves to an array of DocumentLink-instances.</li></ul><p><code>vscode.previewHtml</code> - Render the HTML of the resource in an editor view.</p><ul><li><em>uri</em> Uri of the resource to preview.</li><li><em>column</em> (optional) Column in which to preview.</li><li><em>label</em> (optional) An human readable string that is used as title for the preview.</li></ul><p>See <a href="/docs/extensionapi/vscode-api-commands.html#working-with-the-html-preview">working with the HTML preview</a> for more information about the HTML preview’s integration with the editor and for best practices for extension authors.</p><p><code>vscode.openFolder</code> - Open a folder in the current window or new window depending on the newWindow argument. Note that opening in the same window will shutdown the current extension host process and start a new one on the given folder unless the newWindow parameter is set to true.</p><ul><li><em>uri</em> (optional) Uri of the folder to open. If not provided, a native dialog will ask the user for the folder</li><li><em>newWindow</em> (optional) Whether to open the folder in a new window or the same. Defaults to opening in the same window.</li></ul><p><code>vscode.startDebug</code> - Start a debugging session.</p><ul><li><em>configuration</em> (optional) Name of the debug configuration from ‘launch.json’ to use. Or a configuration json object to use.</li></ul><p><code>vscode.diff</code> - Opens the provided resources in the diff editor to compare their contents.</p><ul><li><em>left</em> Left-hand side resource of the diff editor</li><li><em>right</em> Right-hand side resource of the diff editor</li><li><em>title</em> (optional) Human readable title for the diff editor</li><li><em>options</em> (optional) Editor options, see vscode.TextDocumentShowOptions</li></ul><p><code>vscode.open</code> - Opens the provided resource in the editor. Can be a text or binary file, or a http(s) url</p><ul><li><em>resource</em> Resource to open</li><li><em>column</em> (optional) Column in which to open</li></ul><p><code>cursorMove</code> - Move cursor to a logical position in the view</p><ul><li><p><em>Cursor move argument object</em></p><p>Property-value pairs that can be passed through this argument:</p><ul><li><p>‘to’: A mandatory logical position value providing where to move the cursor.</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&apos;left&apos;, &apos;right&apos;, &apos;up&apos;, &apos;down&apos;</div><div class="line">&apos;wrappedLineStart&apos;, &apos;wrappedLineEnd&apos;, &apos;wrappedLineColumnCenter&apos;</div><div class="line">&apos;wrappedLineFirstNonWhitespaceCharacter&apos;, &apos;wrappedLineLastNonWhitespaceCharacter&apos;</div><div class="line">&apos;viewPortTop&apos;, &apos;viewPortCenter&apos;, &apos;viewPortBottom&apos;, &apos;viewPortIfOutside&apos;</div></pre></td></tr></table></figure></li><li><p>‘by’: Unit to move. Default is computed based on ‘to’ value.</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&apos;line&apos;, &apos;wrappedLine&apos;, &apos;character&apos;, &apos;halfLine&apos;</div></pre></td></tr></table></figure></li><li><p>‘value’: Number of units to move. Default is ‘1’.</p></li><li>‘select’: If ‘true’ makes the selection. Default is ‘false’.</li></ul></li></ul><p><code>editorScroll</code> - Scroll editor in the given direction</p><ul><li><p><em>Editor scroll argument object</em></p><p>Property-value pairs that can be passed through this argument:</p><ul><li><p>‘to’: A mandatory direction value.</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&apos;up&apos;, &apos;down&apos;</div></pre></td></tr></table></figure></li><li><p>‘by’: Unit to move. Default is computed based on ‘to’ value.</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&apos;line&apos;, &apos;wrappedLine&apos;, &apos;page&apos;, &apos;halfPage&apos;</div></pre></td></tr></table></figure></li><li><p>‘value’: Number of units to move. Default is ‘1’.</p></li><li>‘revealCursor’: If ‘true’ reveals the cursor if it is outside view port.</li></ul></li></ul><p><code>revealLine</code> - Reveal the given line at the given logical position</p><ul><li><p><em>Reveal line argument object</em></p><p>Property-value pairs that can be passed through this argument:</p><ul><li>‘lineNumber’: A mandatory line number value.</li><li>‘at’: Logical position at which line has to be revealed .<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&apos;top&apos;, &apos;center&apos;, &apos;bottom&apos;</div></pre></td></tr></table></figure></li></ul></li></ul><p><code>editor.unfold</code> - Unfold the content in the editor</p><ul><li><p><em>Unfold editor argument</em></p><p>Property-value pairs that can be passed through this argument:</p><ul><li>‘level’: Number of levels to unfold</li></ul></li></ul><p><code>editor.fold</code> - Fold the content in the editor</p><ul><li><p><em>Fold editor argument</em></p><p>Property-value pairs that can be passed through this argument:</p><ul><li>‘levels’: Number of levels to fold</li><li>‘up’: If ‘true’, folds given number of levels up otherwise folds down</li></ul></li></ul><p><code>editor.action.showReferences</code> - Show references at a position in a file</p><ul><li><em>uri</em> The text document in which to show references</li><li><em>position</em> The position at which to show</li><li><em>locations</em> An array of locations.</li></ul><p><code>moveActiveEditor</code> - Move the active editor by tabs or groups</p><ul><li><p><em>Active editor move argument</em></p><p>Argument Properties:</p><ul><li>‘to’: String value providing where to move.</li><li>‘by’: String value providing the unit for move. By tab or by group.</li><li>‘value’: Number value providing how many positions or an absolute position to move.</li></ul></li></ul><h2 id="Working-With-the-HTML-Preview" class="article-heading"><a href="#Working-With-the-HTML-Preview" class="headerlink" title="Working With the HTML Preview"></a>Working With the HTML Preview<a class="article-anchor" href="#Working-With-the-HTML-Preview" aria-hidden="true"></a></h2><h3 id="Styling" class="article-heading"><a href="#Styling" class="headerlink" title="Styling"></a>Styling<a class="article-anchor" href="#Styling" aria-hidden="true"></a></h3><p>The body element of the displayed HTML is dynamically annotated with one of the following CSS classes in order to communicate the kind of color theme VS Code is currently using: <code>vscode-light</code>, <code>vscode-dark</code>, or <code>vscode-high-contrast</code>.</p><h3 id="Links" class="article-heading"><a href="#Links" class="headerlink" title="Links"></a>Links<a class="article-anchor" href="#Links" aria-hidden="true"></a></h3><p>Links contained in the document will be handled by VS Code whereby it supports <code>file</code>-resources and <a href="https://github.com/Microsoft/vscode/blob/master/src/vs/vscode.d.ts#L3295" target="_blank" rel="external">virtual</a> resources as well as triggering commands using the <code>command</code> scheme. Use the query part of a command-uri to pass along JSON encoded arguments. Note that URL encoding must be applied.</p><p>The snippet below defines a command link that calls the <em>previewHtml</em> command and passes along an URI:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> href = <span class="built_in">encodeURI</span>(<span class="string">'command:vscode.previewHtml?'</span> + <span class="built_in">JSON</span>.stringify(someUri));</div><div class="line"><span class="keyword">let</span> html = <span class="string">'&lt;a href="'</span> + href + <span class="string">'"&gt;Show Resource...&lt;/a&gt;.'</span>;</div></pre></td></tr></table></figure><h3 id="Security-Tips" class="article-heading"><a href="#Security-Tips" class="headerlink" title="Security Tips"></a>Security Tips<a class="article-anchor" href="#Security-Tips" aria-hidden="true"></a></h3><p>As an extension author, if you use an HTML preview, you are responsible for protecting users from potentially malicious content. The primary danger is that an attacker could craft a malicious workspace that uses your HTML preview to execute scripts or perform other insecure activities. In addition to normal web security best practices, here are a few specific tips and tricks to help protect users.</p><h3 id="Sanitizing-Content" class="article-heading"><a href="#Sanitizing-Content" class="headerlink" title="Sanitizing Content"></a>Sanitizing Content<a class="article-anchor" href="#Sanitizing-Content" aria-hidden="true"></a></h3><p>As a first line of defense, when constructing an HTML document for the preview, make sure to appropriately sanitize all input that comes from workspace settings or from files on a user’s system. For HTML content, consider using a whitelist of safe tags and attributes. Libraries such as <a href="https://www.npmjs.com/package/sanitize-html" target="_blank" rel="external">sanitize-html</a> can help with this.</p><h3 id="Disabling-Scripts" class="article-heading"><a href="#Disabling-Scripts" class="headerlink" title="Disabling Scripts"></a>Disabling Scripts<a class="article-anchor" href="#Disabling-Scripts" aria-hidden="true"></a></h3><p>If your preview does not need to execute JavaScript, you can further enhance security by disabling script execution entirely. One way to accomplish this is by loading untrusted content inside of an <code>iframe</code> with the <code>sandbox</code> attribute set. In this case, the content would be loaded using the <code>srcdoc</code> attribute:</p><figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">sandbox</span> <span class="attr">srcdoc</span>=<span class="string">"&lt;!DOCTYPE html&gt;..."</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></div></pre></td></tr></table></figure><p>If your preview still needs to load some local resources such as images, try using <code>sandbox=&quot;allow-same-origin&quot;</code> instead:</p><figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">sandbox</span>=<span class="string">"allow-same-origin"</span> <span class="attr">srcdoc</span>=<span class="string">"&lt;!DOCTYPE html&gt;..."</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></div></pre></td></tr></table></figure><p><code>sandbox=&quot;allow-same-origin&quot;</code> disables script execution inside the <code>iframe</code> but allows loading resources from a user’s system, such as stylesheets and images. In general, it is best to disable access to local resources unless your preview absolutely needs it.</p><h3 id="Using-a-Content-Security-Policy" class="article-heading"><a href="#Using-a-Content-Security-Policy" class="headerlink" title="Using a Content Security Policy"></a>Using a Content Security Policy<a class="article-anchor" href="#Using-a-Content-Security-Policy" aria-hidden="true"></a></h3><p>If your preview’s functionality depends on scripts, consider disabling scripts that come from untrusted user content using a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" target="_blank" rel="external">content security policy</a>. Content security policy allow fine grained control over which resources may be loaded.</p><p>For example, here’s a content security policy that allows images from anywhere, allows stylesheets from a user’s local system, and disables all scripts:</p><figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Security-Policy"</span> <span class="attr">content</span>=<span class="string">"default-src 'none'; img-src *; style-src 'self'; script-src 'none';"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>...<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  Content</div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure><p>To selectively enable scripts, the best approach for the HTML preview is to use a dynamically generated <a href="https://developers.google.com/web/fundamentals/security/csp/" target="_blank" rel="external">nonce</a> to whitelist certain trusted scripts:</p><figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Security-Policy"</span> <span class="attr">content</span>=<span class="string">"default-src 'none'; img-src *; style-src 'self'; script-src 'nonce-123456';"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>...<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  Content</div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">"123456"</span> <span class="attr">src</span>=<span class="string">"file:///path/to/extension/my_trusted_script.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></div><footer class="article-footer"><time class="article-updated" datetime="2017-06-09T10:29:06.984Z" itemprop="dateModified">Last updated: 2017-06-09</time></footer></div></div><aside id="article-toc" role="navigation"><div id="article-toc-inner"><strong class="sidebar-title">Contents</strong><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Complex-Commands"><span class="toc-text">Complex Commands</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Commands"><span class="toc-text">Commands</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Working-With-the-HTML-Preview"><span class="toc-text">Working With the HTML Preview</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Styling"><span class="toc-text">Styling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Links"><span class="toc-text">Links</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Security-Tips"><span class="toc-text">Security Tips</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sanitizing-Content"><span class="toc-text">Sanitizing Content</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Disabling-Scripts"><span class="toc-text">Disabling Scripts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-a-Content-Security-Policy"><span class="toc-text">Using a Content Security Policy</span></a></li></ol></li></ol></li></ol><a href="#" id="article-toc-top">Back to Top</a></div></aside></div></article><aside id="sidebar" role="navigation"><div class="inner"><div class="accordion"><label class="sidebar-title" for="Setup">Setup<i></i></label><input id="Setup" type="checkbox"><div class="ac-cont"><a href="/docs/setup/setup-overview.html" class="sidebar-link">Overview</a><a href="/docs/setup/linux.html" class="sidebar-link">Linux</a><a href="/docs/setup/windows.html" class="sidebar-link">Windows</a><a href="/docs/setup/network.html" class="sidebar-link">Network</a><a href="/docs/setup/additional-components.html" class="sidebar-link">Additional Compnents</a></div><label class="sidebar-title" for="GetStarted">GetStarted<i></i></label><input id="GetStarted" type="checkbox"><div class="ac-cont"><a href="/docs/getstarted/introvideos.html" class="sidebar-link">Intro Videos</a><a href="/docs/getstarted/userinterface.html" class="sidebar-link">User Interface</a><a href="/docs/getstarted/themes.html" class="sidebar-link">Themes</a><a href="/docs/getstarted/settings.html" class="sidebar-link">Settings</a><a href="/docs/getstarted/keybindings.html" class="sidebar-link">Key Bindings</a><a href="/docs/getstarted/locales.html" class="sidebar-link">Display Language</a></div><label class="sidebar-title" for="UserGuide">UserGuide<i></i></label><input id="UserGuide" type="checkbox"><div class="ac-cont"><a href="/docs/userguide/codebasics.html" class="sidebar-link">Basic Editing</a><a href="/docs/userguide/intellisense.html" class="sidebar-link">IntelliSense</a><a href="/docs/userguide/editingevolved.html" class="sidebar-link">Code Navigation</a><a href="/docs/userguide/debugging.html" class="sidebar-link">Debugging</a><a href="/docs/userguide/versioncontrol.html" class="sidebar-link">Version Control</a><a href="/docs/userguide/integrated-terminal.html" class="sidebar-link">Integrated Terminal</a><a href="/docs/userguide/tasks.html" class="sidebar-link">Tasks</a><a href="/docs/userguide/userdefinedsnippets.html" class="sidebar-link">Creating your own Snippets</a><a href="/docs/userguide/emmet.html" class="sidebar-link">Emmet</a><a href="/docs/userguide/command-line.html" class="sidebar-link">Command Line</a><a href="/docs/userguide/accessibility.html" class="sidebar-link">Accessibility</a></div><label class="sidebar-title" for="Languages">Languages<i></i></label><input id="Languages" type="checkbox"><div class="ac-cont"><a href="/docs/languages/overview.html" class="sidebar-link">Overview</a><a href="/docs/languages/html.html" class="sidebar-link">HTML</a><a href="/docs/languages/css.html" class="sidebar-link">CSS, Sass and Less</a><a href="/docs/languages/cpp.html" class="sidebar-link">C++</a></div><label class="sidebar-title" for="Extensions">Extensions<i></i></label><input id="Extensions" type="checkbox"><div class="ac-cont"><a href="/docs/extensions/overview.html" class="sidebar-link">Overview</a><a href="/docs/extensions/yocode.html" class="sidebar-link">Extension Generator</a><a href="/docs/extensions/samples.html" class="sidebar-link">Additional Examples</a><a href="/docs/extensions/publish-extension.html" class="sidebar-link">Publishing Extensions</a></div><label class="sidebar-title" for="ExtensionAPI">ExtensionAPI<i></i></label><input id="ExtensionAPI" type="checkbox" checked><div class="ac-cont"><a href="/docs/extensionapi/overview.html" class="sidebar-link">Overview</a><a href="/docs/extensionapi/extension-manifest.html" class="sidebar-link">Extension Manifest</a><a href="/docs/extensionapi/extension-points.html" class="sidebar-link">Extension Points</a><a href="/docs/extensionapi/activation-events.html" class="sidebar-link">Activation Events</a><a href="/docs/extensionapi/vscode-api.html" class="sidebar-link">vscode namespace API</a><a href="/docs/extensionapi/vscode-api-commands.html" class="sidebar-link current">Complex Commands</a><a href="/docs/extensionapi/api-scm.html" class="sidebar-link">Source Control API</a></div><label class="sidebar-title" for="Supporting">Supporting<i></i></label><input id="Supporting" type="checkbox"><div class="ac-cont"><a href="/docs/supporting/faq.html" class="sidebar-link">FAQ</a><a href="/docs/supporting/requirements.html" class="sidebar-link">Requirements</a><a href="/docs/supporting/errors.html" class="sidebar-link">Errors</a></div><label class="sidebar-title" for="Other">Other<i></i></label><input id="Other" type="checkbox"><div class="ac-cont"><a href="/docs/other/dotnet.html" class="sidebar-link">.NET Core</a></div></div></div></aside></div></div></div></div><div id="mobile-nav-dimmer"></div><nav id="mobile-nav"><div id="mobile-nav-inner"><ul id="mobile-nav-list"><a href="/docs/" class="mobile-nav-link">Docs</a><a href="/updates/" class="mobile-nav-link">Updates</a></ul><strong class="mobile-nav-title">Setup</strong><a href="/docs/setup/setup-overview.html" class="mobile-nav-link">Overview</a><a href="/docs/setup/linux.html" class="mobile-nav-link">Linux</a><a href="/docs/setup/windows.html" class="mobile-nav-link">Windows</a><a href="/docs/setup/network.html" class="mobile-nav-link">Network</a><a href="/docs/setup/additional-components.html" class="mobile-nav-link">Additional Compnents</a><strong class="mobile-nav-title">GetStarted</strong><a href="/docs/getstarted/introvideos.html" class="mobile-nav-link">Intro Videos</a><a href="/docs/getstarted/userinterface.html" class="mobile-nav-link">User Interface</a><a href="/docs/getstarted/themes.html" class="mobile-nav-link">Themes</a><a href="/docs/getstarted/settings.html" class="mobile-nav-link">Settings</a><a href="/docs/getstarted/keybindings.html" class="mobile-nav-link">Key Bindings</a><a href="/docs/getstarted/locales.html" class="mobile-nav-link">Display Language</a><strong class="mobile-nav-title">UserGuide</strong><a href="/docs/userguide/codebasics.html" class="mobile-nav-link">Basic Editing</a><a href="/docs/userguide/intellisense.html" class="mobile-nav-link">IntelliSense</a><a href="/docs/userguide/editingevolved.html" class="mobile-nav-link">Code Navigation</a><a href="/docs/userguide/debugging.html" class="mobile-nav-link">Debugging</a><a href="/docs/userguide/versioncontrol.html" class="mobile-nav-link">Version Control</a><a href="/docs/userguide/integrated-terminal.html" class="mobile-nav-link">Integrated Terminal</a><a href="/docs/userguide/tasks.html" class="mobile-nav-link">Tasks</a><a href="/docs/userguide/userdefinedsnippets.html" class="mobile-nav-link">Creating your own Snippets</a><a href="/docs/userguide/emmet.html" class="mobile-nav-link">Emmet</a><a href="/docs/userguide/command-line.html" class="mobile-nav-link">Command Line</a><a href="/docs/userguide/accessibility.html" class="mobile-nav-link">Accessibility</a><strong class="mobile-nav-title">Languages</strong><a href="/docs/languages/overview.html" class="mobile-nav-link">Overview</a><a href="/docs/languages/html.html" class="mobile-nav-link">HTML</a><a href="/docs/languages/css.html" class="mobile-nav-link">CSS, Sass and Less</a><a href="/docs/languages/cpp.html" class="mobile-nav-link">C++</a><strong class="mobile-nav-title">Extensions</strong><a href="/docs/extensions/overview.html" class="mobile-nav-link">Overview</a><a href="/docs/extensions/yocode.html" class="mobile-nav-link">Extension Generator</a><a href="/docs/extensions/samples.html" class="mobile-nav-link">Additional Examples</a><a href="/docs/extensions/publish-extension.html" class="mobile-nav-link">Publishing Extensions</a><strong class="mobile-nav-title">ExtensionAPI</strong><a href="/docs/extensionapi/overview.html" class="mobile-nav-link">Overview</a><a href="/docs/extensionapi/extension-manifest.html" class="mobile-nav-link">Extension Manifest</a><a href="/docs/extensionapi/extension-points.html" class="mobile-nav-link">Extension Points</a><a href="/docs/extensionapi/activation-events.html" class="mobile-nav-link">Activation Events</a><a href="/docs/extensionapi/vscode-api.html" class="mobile-nav-link">vscode namespace API</a><a href="/docs/extensionapi/vscode-api-commands.html" class="mobile-nav-link current">Complex Commands</a><a href="/docs/extensionapi/api-scm.html" class="mobile-nav-link">Source Control API</a><strong class="mobile-nav-title">Supporting</strong><a href="/docs/supporting/faq.html" class="mobile-nav-link">FAQ</a><a href="/docs/supporting/requirements.html" class="mobile-nav-link">Requirements</a><a href="/docs/supporting/errors.html" class="mobile-nav-link">Errors</a><strong class="mobile-nav-title">Other</strong><a href="/docs/other/dotnet.html" class="mobile-nav-link">.NET Core</a></div></nav><a id="scroll-to-top" role="button" aria-label="scroll to top" onclick="container.scrollTop=0"><span class="icon"></span></a><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script><script src="/js/toc.js"></script><script src="/js/mobile_nav.js"></script><script src="/js/plugins.js"></script></body></html>