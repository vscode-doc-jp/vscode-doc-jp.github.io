<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><title>Visual Studio Code Docs</title><meta name="description" content="Visual Studio Code (VS Code) Docs の日本語訳"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://vscode-doc-jp.github.io/docs/extensions/example-word-count.html"><link rel="stylesheet" href="/css/navy.css"><link rel="stylesheet" href="/css/accordion.css"><link rel="alternate" href="/atom.xml" title="Visual Studio Code Docs"><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-92801937-1","auto"),ga("send","pageview")</script></head><body><div id="container"><header id="header" class="wrapper"><div id="header-inner" class="inner"><h1 id="logo-wrap"><a href="/" id="logo">Visual Studio Code</a></h1><nav id="main-nav"><a href="/docs/" class="main-nav-link">Docs</a><a href="/updates/" class="main-nav-link">Updates</a><div id="search-input-wrap"><div id="search-input-icon"><i class="fa fa-search"></i></div><input type="search" id="search-input" placeholder="Search..."></div></nav><a id="mobile-nav-toggle"><span class="mobile-nav-toggle-bar"></span> <span class="mobile-nav-toggle-bar"></span> <span class="mobile-nav-toggle-bar"></span></a></div></header><div id="content-wrap"><div id="content" class="wrapper"><div id="content-inner"><header role="navigation"><div class="inner"><nav class="small_nav"><h4>Topics</h4><form name="SmallNav"><select class="small_nav_dropdown" name="doropdown" onchange="location.href=document.SmallNav.doropdown.options[document.SmallNav.doropdown.selectedIndex].value"><optgroup class="small-nav-title" label="Setup"><option value="/docs/setup/setup-overview.html" class="small-nav-link" undefined>Overview</option><option value="/docs/setup/linux.html" class="small-nav-link" undefined>Linux</option><option value="/docs/setup/windows.html" class="small-nav-link" undefined>Windows</option><option value="/docs/setup/network.html" class="small-nav-link" undefined>Network</option><option value="/docs/setup/additional-components.html" class="small-nav-link" undefined>Additional Compnents</option></optgroup><optgroup class="small-nav-title" label="GetStarted"><option value="/docs/getstarted/introvideos.html" class="small-nav-link" undefined>Intro Videos</option><option value="/docs/getstarted/userinterface.html" class="small-nav-link" undefined>User Interface</option><option value="/docs/getstarted/themes.html" class="small-nav-link" undefined>Themes</option><option value="/docs/getstarted/settings.html" class="small-nav-link" undefined>Settings</option><option value="/docs/getstarted/keybindings.html" class="small-nav-link" undefined>Key Bindings</option><option value="/docs/getstarted/locales.html" class="small-nav-link" undefined>Display Language</option></optgroup><optgroup class="small-nav-title" label="UserGuide"><option value="/docs/userguide/codebasics.html" class="small-nav-link" undefined>Basic Editing</option><option value="/docs/userguide/intellisense.html" class="small-nav-link" undefined>IntelliSense</option><option value="/docs/userguide/editingevolved.html" class="small-nav-link" undefined>Code Navigation</option><option value="/docs/userguide/debugging.html" class="small-nav-link" undefined>Debugging</option><option value="/docs/userguide/versioncontrol.html" class="small-nav-link" undefined>Version Control</option><option value="/docs/userguide/integrated-terminal.html" class="small-nav-link" undefined>Integrated Terminal</option><option value="/docs/userguide/tasks.html" class="small-nav-link" undefined>Tasks</option><option value="/docs/userguide/userdefinedsnippets.html" class="small-nav-link" undefined>Creating your own Snippets</option><option value="/docs/userguide/command-line.html" class="small-nav-link" undefined>Command Line</option><option value="/docs/userguide/accessibility.html" class="small-nav-link" undefined>Accessibility</option></optgroup><optgroup class="small-nav-title" label="Languages"><option value="/docs/languages/overview.html" class="small-nav-link" undefined>Overview</option><option value="/docs/languages/html.html" class="small-nav-link" undefined>HTML</option><option value="/docs/languages/css.html" class="small-nav-link" undefined>CSS, Sass and Less</option><option value="/docs/languages/cpp.html" class="small-nav-link" undefined>C++</option></optgroup><optgroup class="small-nav-title" label="Extensions"><option value="/docs/extensions/overview.html" class="small-nav-link" undefined>Overview</option><option value="/docs/extensions/yocode.html" class="small-nav-link" undefined>Extension Generator</option><option value="/docs/extensions/samples.html" class="small-nav-link" undefined>Additional Examples</option><option value="/docs/extensions/publish-extension.html" class="small-nav-link" undefined>Publishing Extensions</option></optgroup><optgroup class="small-nav-title" label="ExtensionAPI"><option value="/docs/extensionapi/overview.html" class="small-nav-link" undefined>Overview</option><option value="/docs/extensionapi/extension-manifest.html" class="small-nav-link" undefined>Extension Manifest</option><option value="/docs/extensionapi/extension-points.html" class="small-nav-link" undefined>Extension Points</option><option value="/docs/extensionapi/activation-events.html" class="small-nav-link" undefined>Activation Events</option><option value="/docs/extensionapi/vscode-api.html" class="small-nav-link" undefined>vscode namespace API</option><option value="/docs/extensionapi/vscode-api-commands.html" class="small-nav-link" undefined>Complex Commands</option><option value="/docs/extensionapi/api-scm.html" class="small-nav-link" undefined>Source Control API</option></optgroup><optgroup class="small-nav-title" label="Supporting"><option value="/docs/supporting/faq.html" class="small-nav-link" undefined>FAQ</option><option value="/docs/supporting/requirements.html" class="small-nav-link" undefined>Requirements</option><option value="/docs/supporting/errors.html" class="small-nav-link" undefined>Errors</option></optgroup><optgroup class="small-nav-title" label="Other"><option value="/docs/other/dotnet.html" class="small-nav-link" undefined>.NET Core</option></optgroup></select></form></nav></div></header><article class="article-container" itemscope itemtype="http://schema.org/Article"><div class="article-inner"><div class="article"><div class="inner"><header class="article-header"><h1 class="article-title" itemprop="name"></h1><a href="https://github.com/vscode-doc-jp/Docs/edit/master/extensions/example-word-count.md" class="article-edit-link" title="Improve this doc"><i class="fa fa-pencil"></i></a><h2><time class="article-updated" data-position="header" datetime="2017-05-05T06:15:11.637Z" itemprop="dateModified">Last updated: 2017-05-05</time></h2></header><div class="article-content" itemprop="articleBody"><h1 id="Example-Word-Count" class="article-heading"><a href="#Example-Word-Count" class="headerlink" title="Example - Word Count"></a>Example - Word Count<a class="article-anchor" href="#Example-Word-Count" aria-hidden="true"></a></h1><p>This document assumes you have read <a href="/docs/extensions/example-hello-world.html">Your First Extension</a> which covers the basics of VS Code extensibility.</p><p>Word Count is an end to end tutorial to show you how to create an extension to aid in Markdown authoring. Before we get into how all of this works, let’s have a quick demo of the core features you will be building so you know what to expect.</p><p>Whenever a <code>Markdown</code> file is edited, a status bar message is added. The message includes the current word count and updates as you type and move from file to file:</p><p><img src="images/example-word-count/wordcountevent2.gif" alt="Word Count on Status Bar"></p><blockquote><p><strong>Tip:</strong> The finished sample is available from <a href="https://github.com/microsoft/vscode-wordcount" target="_blank" rel="external">this GitHub repository</a> should you have any issues.</p></blockquote><h2 id="Overview" class="article-heading"><a href="#Overview" class="headerlink" title="Overview"></a>Overview<a class="article-anchor" href="#Overview" aria-hidden="true"></a></h2><p>This example has three sections which will take you through a set of related concepts:</p><ol><li><a href="/docs/extensions/example-word-count.html#update-the-status-bar">Update the Status Bar</a> - display custom text in the VS Code <code>Status Bar</code></li><li><a href="/docs/extensions/example-word-count.html#subscribing-to-events">Subscribing to Events</a> - updating the <code>Status Bar</code> based on editor events</li><li><a href="/docs/extensions/example-word-count.html#disposing-extension-resources">Disposing Extension Resources</a> - release resources like event subscriptions or UI handles</li></ol><p>First make sure you have the latest VS Code extension generator installed then run it:</p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">npm install -g yo generator-code</div><div class="line">yo code</div></pre></td></tr></table></figure><p>This will open up the extension generator - we will base this example on the TypeScript <code>New Extension</code> option. For now, fill in the fields the same way you see them completed in the image below (using ‘WordCount’ as the extension name and your own name as the publisher).</p><p><img src="images/example-word-count/yo1.png" alt="Yo Code Word Count Example Output"></p><p>You can now open VS Code as described in the generator output:</p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line"><span class="built_in">cd</span> WordCount</div><div class="line">code .</div></pre></td></tr></table></figure><h2 id="Run-the-Extension" class="article-heading"><a href="#Run-the-Extension" class="headerlink" title="Run the Extension"></a>Run the Extension<a class="article-anchor" href="#Run-the-Extension" aria-hidden="true"></a></h2><p>Before we go on, we can run the extension to make sure everything works as expected by pressing <span class="dynamic-keybinding" data-osx="F5" data-win="F5" data-linux="F5"><span class="keybinding">F5</span></span>. As you saw in the previous “Hello World” walkthrough, VS Code opens another window (the <strong>[Extension Development Host]</strong> window) in which your extension will be loaded. You should find the “Hello World” command in the Command Palette (press <span class="dynamic-keybinding" data-osx="⇧⌘P" data-win="Ctrl+Shift+P" data-linux="Ctrl+Shift+P"><span class="keybinding">⇧⌘P</span> (Windows, Linux <span class="keybinding">Ctrl+Shift+P</span>)</span>) and when you select it, you will see an information box at the top of the window saying “Hello World”.</p><p>Now that you have confirmed that the extension is running properly, you can keep the extension development window open if you like. To test out any changes that you make to your extension, you can either press <span class="dynamic-keybinding" data-osx="F5" data-win="F5" data-linux="F5"><span class="keybinding">F5</span></span> again in the development window or reload the extension development window by pressing <span class="keybinding">Ctrl+R</span> (Mac: <span class="keybinding">Cmd+R</span>).</p><h2 id="Update-the-Status-Bar" class="article-heading"><a href="#Update-the-Status-Bar" class="headerlink" title="Update the Status Bar"></a>Update the Status Bar<a class="article-anchor" href="#Update-the-Status-Bar" aria-hidden="true"></a></h2><p>Replace the contents of the generated <code>extension.ts</code> file with the code shown below. It declares and instantiates a <code>WordCounter</code> class which can count words and shows them in the VS Code Status Bar. The “Hello Word” command will call <code>updateWordCount</code> when invoked.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="comment">// The module 'vscode' contains the VS Code extensibility API</span></div><div class="line"><span class="comment">// Import the necessary extensibility types to use in your code below</span></div><div class="line"><span class="keyword">import</span> &#123;<span class="built_in">window</span>, commands, Disposable, ExtensionContext, StatusBarAlignment, StatusBarItem, TextDocument&#125; <span class="keyword">from</span> <span class="string">'vscode'</span>;</div><div class="line"></div><div class="line"><span class="comment">// This method is called when your extension is activated. Activation is</span></div><div class="line"><span class="comment">// controlled by the activation events defined in package.json.</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">activate</span>(<span class="params">context: ExtensionContext</span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// Use the console to output diagnostic information (console.log) and errors (console.error).</span></div><div class="line">    <span class="comment">// This line of code will only be executed once when your extension is activated.</span></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Congratulations, your extension "WordCount" is now active!'</span>);</div><div class="line"></div><div class="line">    <span class="comment">// create a new word counter</span></div><div class="line">    <span class="keyword">let</span> wordCounter = <span class="keyword">new</span> WordCounter();</div><div class="line"></div><div class="line">    <span class="keyword">var</span> disposable = commands.registerCommand(<span class="string">'extension.sayHello'</span>, () =&gt; &#123;</div><div class="line">        wordCounter.updateWordCount();</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="comment">// Add to a list of disposables which are disposed when this extension is deactivated.</span></div><div class="line">    context.subscriptions.push(wordCounter);</div><div class="line">    context.subscriptions.push(disposable);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WordCounter</span> </span>&#123;</div><div class="line"></div><div class="line">    private _statusBarItem: StatusBarItem;</div><div class="line"></div><div class="line">    public updateWordCount() &#123;</div><div class="line"></div><div class="line">        <span class="comment">// Create as needed</span></div><div class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>._statusBarItem) &#123;</div><div class="line">            <span class="keyword">this</span>._statusBarItem = <span class="built_in">window</span>.createStatusBarItem(StatusBarAlignment.Left);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// Get the current text editor</span></div><div class="line">        <span class="keyword">let</span> editor = <span class="built_in">window</span>.activeTextEditor;</div><div class="line">        <span class="keyword">if</span> (!editor) &#123;</div><div class="line">            <span class="keyword">this</span>._statusBarItem.hide();</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> doc = editor.document;</div><div class="line"></div><div class="line">        <span class="comment">// Only update status if an Markdown file</span></div><div class="line">        <span class="keyword">if</span> (doc.languageId === <span class="string">"markdown"</span>) &#123;</div><div class="line">            <span class="keyword">let</span> wordCount = <span class="keyword">this</span>._getWordCount(doc);</div><div class="line"></div><div class="line">            <span class="comment">// Update the status bar</span></div><div class="line">            <span class="keyword">this</span>._statusBarItem.text = wordCount !== <span class="number">1</span> ? <span class="string">`<span class="subst">$&#123;wordCount&#125;</span> Words`</span> : <span class="string">'1 Word'</span>;</div><div class="line">            <span class="keyword">this</span>._statusBarItem.show();</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">this</span>._statusBarItem.hide();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public _getWordCount(doc: TextDocument): number &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> docContent = doc.getText();</div><div class="line"></div><div class="line">        <span class="comment">// Parse out unwanted whitespace so the split is accurate</span></div><div class="line">        docContent = docContent.replace(<span class="regexp">/(&lt; ([^&gt;]+)&lt;)/g</span>, <span class="string">''</span>).replace(<span class="regexp">/\s+/g</span>, <span class="string">' '</span>);</div><div class="line">        docContent = docContent.replace(<span class="regexp">/^\s\s*/</span>, <span class="string">''</span>).replace(<span class="regexp">/\s\s*$/</span>, <span class="string">''</span>);</div><div class="line">        <span class="keyword">let</span> wordCount = <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span> (docContent != <span class="string">""</span>) &#123;</div><div class="line">            wordCount = docContent.split(<span class="string">" "</span>).length;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> wordCount;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    dispose() &#123;</div><div class="line">        <span class="keyword">this</span>._statusBarItem.dispose();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Now let’s try our updates to the extension.</p><p>We have the compilation of the TypeScript file set on a watch (in the extension’s .vscode\tasks.json file) so there is no need to re-build. Hit <span class="keybinding">Ctrl+R</span> in the <strong>[Extension Development Host]</strong> window where your code is running and the extension will reload (you can also just <span class="dynamic-keybinding" data-osx="F5" data-win="F5" data-linux="F5"><span class="keybinding">F5</span></span> from your primary development window). We still need to activate the code in the same way as before with the “Hello World” command. Assuming you are in a Markdown file, your Status Bar will display the word count.</p><p><img src="images/example-word-count/wordcount2.png" alt="Working Word Count"></p><p>This is a good start but it would be cooler if the count updated as your file changed.</p><h2 id="Subscribing-to-Events" class="article-heading"><a href="#Subscribing-to-Events" class="headerlink" title="Subscribing to Events"></a>Subscribing to Events<a class="article-anchor" href="#Subscribing-to-Events" aria-hidden="true"></a></h2><p>Let’s hook your helper class up to a set of events.</p><ul><li><code>onDidChangeTextEditorSelection</code> - Event is raised as the cursor position changes</li><li><code>onDidChangeActiveTextEditor</code> - Event is raised as the active editor changes.</li></ul><p>To do this, we’ll add a new class into the <code>extension.ts</code> file. It will set up subscriptions to those events and ask the <code>WordCounter</code> to update the word count. Also note how this class manages the subscription as Disposables and how it stops listing when being disposed itself.</p><p>Add the <code>WordCounterController</code> as shown below to the bottom of the <code>extension.ts</code> file.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WordCounterController</span> </span>&#123;</div><div class="line"></div><div class="line">    private _wordCounter: WordCounter;</div><div class="line">    private _disposable: Disposable;</div><div class="line"></div><div class="line">    <span class="keyword">constructor</span>(wordCounter: WordCounter) &#123;</div><div class="line">        <span class="keyword">this</span>._wordCounter = wordCounter;</div><div class="line">        <span class="keyword">this</span>._wordCounter.updateWordCount();</div><div class="line"></div><div class="line">        <span class="comment">// subscribe to selection change and editor activation events</span></div><div class="line">        <span class="keyword">let</span> subscriptions: Disposable[] = [];</div><div class="line">        <span class="built_in">window</span>.onDidChangeTextEditorSelection(<span class="keyword">this</span>._onEvent, <span class="keyword">this</span>, subscriptions);</div><div class="line">        <span class="built_in">window</span>.onDidChangeActiveTextEditor(<span class="keyword">this</span>._onEvent, <span class="keyword">this</span>, subscriptions);</div><div class="line"></div><div class="line">        <span class="comment">// update the counter for the current file</span></div><div class="line">        <span class="keyword">this</span>._wordCounter.updateWordCount();</div><div class="line"></div><div class="line">        <span class="comment">// create a combined disposable from both event subscriptions</span></div><div class="line">        <span class="keyword">this</span>._disposable = Disposable.from(...subscriptions);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    dispose() &#123;</div><div class="line">        <span class="keyword">this</span>._disposable.dispose();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private _onEvent() &#123;</div><div class="line">        <span class="keyword">this</span>._wordCounter.updateWordCount();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>We no longer want the Word Count extension to be loaded when a command is invoked but instead be available for each <em>Markdown</em> file.</p><p>First, replace the body of the <code>activate</code> function with this:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="comment">// Use the console to output diagnostic information (console.log) and errors (console.error).</span></div><div class="line"><span class="comment">// This line of code will only be executed once when your extension is activated.</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Congratulations, your extension "WordCount" is now active!'</span>);</div><div class="line"></div><div class="line"><span class="comment">// create a new word counter</span></div><div class="line"><span class="keyword">let</span> wordCounter = <span class="keyword">new</span> WordCounter();</div><div class="line"><span class="keyword">let</span> controller = <span class="keyword">new</span> WordCounterController(wordCounter);</div><div class="line"></div><div class="line"><span class="comment">// Add to a list of disposables which are disposed when this extension is deactivated.</span></div><div class="line">context.subscriptions.push(controller);</div><div class="line">context.subscriptions.push(wordCounter);</div></pre></td></tr></table></figure><p>Second, we must make sure the extension is activated upon the opening of a <code>Markdown</code> file. To do this, we’ll need to modify the <code>package.json</code> file. Previously the extension was activated via the <code>extension.sayHello</code> command which we no longer need and so we can delete the entire <code>contributes</code> attribute from <code>package.json</code>:</p><figure class="highlight"><table><tr><td class="code"><pre><div class="line">"contributes": &#123;</div><div class="line">    "commands":</div><div class="line">        [&#123;</div><div class="line">            <span class="attr">"command"</span>: <span class="string">"extension.sayHello"</span>,</div><div class="line">            <span class="attr">"title"</span>: <span class="string">"Hello World"</span></div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;,</div></pre></td></tr></table></figure><p>Now change your extension so that it is activated upon the opening of a <em>Markdown</em> file by updating the <code>activationEvents</code> attribute to this:</p><figure class="highlight"><table><tr><td class="code"><pre><div class="line">"activationEvents": [</div><div class="line">    <span class="string">"onLanguage:markdown"</span></div><div class="line">]</div></pre></td></tr></table></figure><p>The <a href="/docs/extensionapi/activation-events.html#activationeventsonlanguage"><code>onLanguage:${language}</code></a> event takes the language id, in this case “markdown”, and will be raised whenever a file of that language is opened.</p><p>Run the extension by either doing a window reload <span class="keybinding">Ctrl+R</span> or with <span class="dynamic-keybinding" data-osx="F5" data-win="F5" data-linux="F5"><span class="keybinding">F5</span></span> and then start editing a Markdown file. You should now should have a live updating Word Count.</p><p><img src="images/example-word-count/wordcountevent2.gif" alt="Word Count Updating on Events"></p><p>If you set a breakpoint on the <code>activate</code> function, you’ll notice that it is only called once when the first Markdown file is opened. The <code>WordCountController</code> constructor runs and subscribes to the editor events so that the <code>updateWordCount</code> function is called as Markdown files are opened and their text changes.</p><h2 id="Customizing-the-Status-Bar" class="article-heading"><a href="#Customizing-the-Status-Bar" class="headerlink" title="Customizing the Status Bar"></a>Customizing the Status Bar<a class="article-anchor" href="#Customizing-the-Status-Bar" aria-hidden="true"></a></h2><p>We’ve seen how you can display formatted text on the Status Bar. VS Code allows you to customize your Status Bar additions even further with color, icons, tooltips and more. Using IntelliSense, you can see the various <code>StatusBarItem</code> fields. Another great resource for learning about the VS Code extensibility APIs is the <code>vscode.d.ts</code> type declaration file included in your generated Extension project. Open <code>node_modules\vscode\vscode.d.ts</code> in the editor, you’ll see the complete VS Code extensibility API with comments.</p><p><img src="images/example-word-count/vscode-d-ts.png" alt="vscode-d-ts file"></p><p>Replace the StatusBarItem update code with:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="comment">// Update the status bar</span></div><div class="line"><span class="keyword">this</span>._statusBarItem.text = wordCount !== <span class="number">1</span> ? <span class="string">`$(pencil) <span class="subst">$&#123;wordCount&#125;</span> Words`</span> : <span class="string">'$(pencil) 1 Word'</span>;</div><div class="line"><span class="keyword">this</span>._statusBarItem.show();</div></pre></td></tr></table></figure><p>to display a <a href="https://octicons.github.com" target="_blank" rel="external">GitHub Octicon</a> <code>pencil</code> icon to the left of the calculated word count.</p><p><img src="images/example-word-count/wordcount-pencil.png" alt="Word Count with pencil icon"></p><h2 id="Disposing-Extension-Resources" class="article-heading"><a href="#Disposing-Extension-Resources" class="headerlink" title="Disposing Extension Resources"></a>Disposing Extension Resources<a class="article-anchor" href="#Disposing-Extension-Resources" aria-hidden="true"></a></h2><p>Now we’ll take a deeper look at how extensions should handle VS Code resources through <a href="/docs/extensionapi/patterns-and-principles.html#disposables">Disposables</a>.</p><p>When an extension is activated, it is passed an <code>ExtensionContext</code> object which has a <code>subscriptions</code> collection of Disposables. Extensions can add their Disposable objects to this collection and VS Code will dispose of those objects when the extension is deactivated.</p><p>Many VS Code APIs which create workspace or UI objects (e.g. <code>registerCommand</code>) return a Disposable and extensions can remove these elements from VS Code by calling their dispose method directly.</p><p>Events are another example where <code>onDid*</code> event subscriber methods return a Disposable. Extensions unsubscribe to an event by disposing the event’s Disposable. In our example, <code>WordCountController</code> handles the event subscription Disposables directly by keeping its own Disposable collection which it cleans up on deactivation.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="comment">// subscribe to selection change and editor activation events</span></div><div class="line"><span class="keyword">let</span> subscriptions: Disposable[] = [];</div><div class="line"><span class="built_in">window</span>.onDidChangeTextEditorSelection(<span class="keyword">this</span>._onEvent, <span class="keyword">this</span>, subscriptions);</div><div class="line"><span class="built_in">window</span>.onDidChangeActiveTextEditor(<span class="keyword">this</span>._onEvent, <span class="keyword">this</span>, subscriptions);</div><div class="line"></div><div class="line"><span class="comment">// create a combined disposable from both event subscriptions</span></div><div class="line"><span class="keyword">this</span>._disposable = Disposable.from(...subscriptions);</div></pre></td></tr></table></figure><h2 id="Installing-your-Extension-Locally" class="article-heading"><a href="#Installing-your-Extension-Locally" class="headerlink" title="Installing your Extension Locally"></a>Installing your Extension Locally<a class="article-anchor" href="#Installing-your-Extension-Locally" aria-hidden="true"></a></h2><p>So far, the extension you have written only runs in a special instance of VS Code, the Extension Development Host instance. To make your extension available to all VS Code instances, copy the extension folder contents to a new folder under <a href="/docs/extensions/yocode.html#your-extensions-folder">your <code>.vscode/extensions</code> folder</a>.</p><h2 id="Publishing-your-Extension" class="article-heading"><a href="#Publishing-your-Extension" class="headerlink" title="Publishing your Extension"></a>Publishing your Extension<a class="article-anchor" href="#Publishing-your-Extension" aria-hidden="true"></a></h2><p>Read about how to <a href="/docs/extensions/publish-extension.html">Share an Extension</a>.</p><h2 id="Next-Steps" class="article-heading"><a href="#Next-Steps" class="headerlink" title="Next Steps"></a>Next Steps<a class="article-anchor" href="#Next-Steps" aria-hidden="true"></a></h2><p>Read on to find out about:</p><ul><li><a href="/docs/extensions/yocode.html">Extension Generator</a> - Learn about other options in the Yo Code extension generator.</li><li><a href="/docs/extensionapi/overview.html">Extension API</a> - Get an overview of the Extension API.</li><li><a href="/docs/extensions/publish-extension.html">Publishing Tool</a> - Learn how to publish an extension to the public Marketplace.</li><li><a href="/docs/extensionapi/vscode-api.html#window">Editor API</a> - Learn more about Text Documents, Text Editors and editing text.</li><li><a href="/docs/extensions/samples.html">Additional Extension Examples</a> - Take a look at our list of example extension projects.</li></ul></div><footer class="article-footer"><time class="article-updated" datetime="2017-05-05T06:15:11.637Z" itemprop="dateModified">Last updated: 2017-05-05</time></footer></div></div><aside id="article-toc" role="navigation"><div id="article-toc-inner"><strong class="sidebar-title">Contents</strong><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Example-Word-Count"><span class="toc-text">Example - Word Count</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Overview"><span class="toc-text">Overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Run-the-Extension"><span class="toc-text">Run the Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Update-the-Status-Bar"><span class="toc-text">Update the Status Bar</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Subscribing-to-Events"><span class="toc-text">Subscribing to Events</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Customizing-the-Status-Bar"><span class="toc-text">Customizing the Status Bar</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Disposing-Extension-Resources"><span class="toc-text">Disposing Extension Resources</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Installing-your-Extension-Locally"><span class="toc-text">Installing your Extension Locally</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Publishing-your-Extension"><span class="toc-text">Publishing your Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Next-Steps"><span class="toc-text">Next Steps</span></a></li></ol></li></ol><a href="#" id="article-toc-top">Back to Top</a></div></aside></div></article><aside id="sidebar" role="navigation"><div class="inner"><div class="accordion"><label class="sidebar-title" for="Setup">Setup<i></i></label><input id="Setup" type="checkbox"><div class="ac-cont"><a href="/docs/setup/setup-overview.html" class="sidebar-link">Overview</a><a href="/docs/setup/linux.html" class="sidebar-link">Linux</a><a href="/docs/setup/windows.html" class="sidebar-link">Windows</a><a href="/docs/setup/network.html" class="sidebar-link">Network</a><a href="/docs/setup/additional-components.html" class="sidebar-link">Additional Compnents</a></div><label class="sidebar-title" for="GetStarted">GetStarted<i></i></label><input id="GetStarted" type="checkbox"><div class="ac-cont"><a href="/docs/getstarted/introvideos.html" class="sidebar-link">Intro Videos</a><a href="/docs/getstarted/userinterface.html" class="sidebar-link">User Interface</a><a href="/docs/getstarted/themes.html" class="sidebar-link">Themes</a><a href="/docs/getstarted/settings.html" class="sidebar-link">Settings</a><a href="/docs/getstarted/keybindings.html" class="sidebar-link">Key Bindings</a><a href="/docs/getstarted/locales.html" class="sidebar-link">Display Language</a></div><label class="sidebar-title" for="UserGuide">UserGuide<i></i></label><input id="UserGuide" type="checkbox"><div class="ac-cont"><a href="/docs/userguide/codebasics.html" class="sidebar-link">Basic Editing</a><a href="/docs/userguide/intellisense.html" class="sidebar-link">IntelliSense</a><a href="/docs/userguide/editingevolved.html" class="sidebar-link">Code Navigation</a><a href="/docs/userguide/debugging.html" class="sidebar-link">Debugging</a><a href="/docs/userguide/versioncontrol.html" class="sidebar-link">Version Control</a><a href="/docs/userguide/integrated-terminal.html" class="sidebar-link">Integrated Terminal</a><a href="/docs/userguide/tasks.html" class="sidebar-link">Tasks</a><a href="/docs/userguide/userdefinedsnippets.html" class="sidebar-link">Creating your own Snippets</a><a href="/docs/userguide/command-line.html" class="sidebar-link">Command Line</a><a href="/docs/userguide/accessibility.html" class="sidebar-link">Accessibility</a></div><label class="sidebar-title" for="Languages">Languages<i></i></label><input id="Languages" type="checkbox"><div class="ac-cont"><a href="/docs/languages/overview.html" class="sidebar-link">Overview</a><a href="/docs/languages/html.html" class="sidebar-link">HTML</a><a href="/docs/languages/css.html" class="sidebar-link">CSS, Sass and Less</a><a href="/docs/languages/cpp.html" class="sidebar-link">C++</a></div><label class="sidebar-title" for="Extensions">Extensions<i></i></label><input id="Extensions" type="checkbox" checked><div class="ac-cont"><a href="/docs/extensions/overview.html" class="sidebar-link">Overview</a><a href="/docs/extensions/yocode.html" class="sidebar-link">Extension Generator</a><a href="/docs/extensions/samples.html" class="sidebar-link">Additional Examples</a><a href="/docs/extensions/publish-extension.html" class="sidebar-link">Publishing Extensions</a></div><label class="sidebar-title" for="ExtensionAPI">ExtensionAPI<i></i></label><input id="ExtensionAPI" type="checkbox"><div class="ac-cont"><a href="/docs/extensionapi/overview.html" class="sidebar-link">Overview</a><a href="/docs/extensionapi/extension-manifest.html" class="sidebar-link">Extension Manifest</a><a href="/docs/extensionapi/extension-points.html" class="sidebar-link">Extension Points</a><a href="/docs/extensionapi/activation-events.html" class="sidebar-link">Activation Events</a><a href="/docs/extensionapi/vscode-api.html" class="sidebar-link">vscode namespace API</a><a href="/docs/extensionapi/vscode-api-commands.html" class="sidebar-link">Complex Commands</a><a href="/docs/extensionapi/api-scm.html" class="sidebar-link">Source Control API</a></div><label class="sidebar-title" for="Supporting">Supporting<i></i></label><input id="Supporting" type="checkbox"><div class="ac-cont"><a href="/docs/supporting/faq.html" class="sidebar-link">FAQ</a><a href="/docs/supporting/requirements.html" class="sidebar-link">Requirements</a><a href="/docs/supporting/errors.html" class="sidebar-link">Errors</a></div><label class="sidebar-title" for="Other">Other<i></i></label><input id="Other" type="checkbox"><div class="ac-cont"><a href="/docs/other/dotnet.html" class="sidebar-link">.NET Core</a></div></div></div></aside></div></div></div></div><div id="mobile-nav-dimmer"></div><nav id="mobile-nav"><div id="mobile-nav-inner"><ul id="mobile-nav-list"><a href="/docs/" class="mobile-nav-link">Docs</a><a href="/updates/" class="mobile-nav-link">Updates</a></ul><strong class="mobile-nav-title">Setup</strong><a href="/docs/setup/setup-overview.html" class="mobile-nav-link">Overview</a><a href="/docs/setup/linux.html" class="mobile-nav-link">Linux</a><a href="/docs/setup/windows.html" class="mobile-nav-link">Windows</a><a href="/docs/setup/network.html" class="mobile-nav-link">Network</a><a href="/docs/setup/additional-components.html" class="mobile-nav-link">Additional Compnents</a><strong class="mobile-nav-title">GetStarted</strong><a href="/docs/getstarted/introvideos.html" class="mobile-nav-link">Intro Videos</a><a href="/docs/getstarted/userinterface.html" class="mobile-nav-link">User Interface</a><a href="/docs/getstarted/themes.html" class="mobile-nav-link">Themes</a><a href="/docs/getstarted/settings.html" class="mobile-nav-link">Settings</a><a href="/docs/getstarted/keybindings.html" class="mobile-nav-link">Key Bindings</a><a href="/docs/getstarted/locales.html" class="mobile-nav-link">Display Language</a><strong class="mobile-nav-title">UserGuide</strong><a href="/docs/userguide/codebasics.html" class="mobile-nav-link">Basic Editing</a><a href="/docs/userguide/intellisense.html" class="mobile-nav-link">IntelliSense</a><a href="/docs/userguide/editingevolved.html" class="mobile-nav-link">Code Navigation</a><a href="/docs/userguide/debugging.html" class="mobile-nav-link">Debugging</a><a href="/docs/userguide/versioncontrol.html" class="mobile-nav-link">Version Control</a><a href="/docs/userguide/integrated-terminal.html" class="mobile-nav-link">Integrated Terminal</a><a href="/docs/userguide/tasks.html" class="mobile-nav-link">Tasks</a><a href="/docs/userguide/userdefinedsnippets.html" class="mobile-nav-link">Creating your own Snippets</a><a href="/docs/userguide/command-line.html" class="mobile-nav-link">Command Line</a><a href="/docs/userguide/accessibility.html" class="mobile-nav-link">Accessibility</a><strong class="mobile-nav-title">Languages</strong><a href="/docs/languages/overview.html" class="mobile-nav-link">Overview</a><a href="/docs/languages/html.html" class="mobile-nav-link">HTML</a><a href="/docs/languages/css.html" class="mobile-nav-link">CSS, Sass and Less</a><a href="/docs/languages/cpp.html" class="mobile-nav-link">C++</a><strong class="mobile-nav-title">Extensions</strong><a href="/docs/extensions/overview.html" class="mobile-nav-link">Overview</a><a href="/docs/extensions/yocode.html" class="mobile-nav-link">Extension Generator</a><a href="/docs/extensions/samples.html" class="mobile-nav-link">Additional Examples</a><a href="/docs/extensions/publish-extension.html" class="mobile-nav-link">Publishing Extensions</a><strong class="mobile-nav-title">ExtensionAPI</strong><a href="/docs/extensionapi/overview.html" class="mobile-nav-link">Overview</a><a href="/docs/extensionapi/extension-manifest.html" class="mobile-nav-link">Extension Manifest</a><a href="/docs/extensionapi/extension-points.html" class="mobile-nav-link">Extension Points</a><a href="/docs/extensionapi/activation-events.html" class="mobile-nav-link">Activation Events</a><a href="/docs/extensionapi/vscode-api.html" class="mobile-nav-link">vscode namespace API</a><a href="/docs/extensionapi/vscode-api-commands.html" class="mobile-nav-link">Complex Commands</a><a href="/docs/extensionapi/api-scm.html" class="mobile-nav-link">Source Control API</a><strong class="mobile-nav-title">Supporting</strong><a href="/docs/supporting/faq.html" class="mobile-nav-link">FAQ</a><a href="/docs/supporting/requirements.html" class="mobile-nav-link">Requirements</a><a href="/docs/supporting/errors.html" class="mobile-nav-link">Errors</a><strong class="mobile-nav-title">Other</strong><a href="/docs/other/dotnet.html" class="mobile-nav-link">.NET Core</a></div></nav><a id="scroll-to-top" role="button" aria-label="scroll to top" onclick="container.scrollTop=0"><span class="icon"></span></a><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script><script src="/js/toc.js"></script><script src="/js/mobile_nav.js"></script><script src="/js/plugins.js"></script></body></html>